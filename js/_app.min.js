function state_set(a,b){"use strict";try{localStorage.setItem(a,b)}catch(c){}}function state_get(a){"use strict";try{return localStorage.getItem(a)}catch(b){return!1}}function state_remove(a){"use strict";try{return localStorage.removeItem(a),!0}catch(b){return!1}}function test_get(){"use strict";var a="modernizr";try{return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(b){return!1}}var timestamp=(new Date).getTime();$(function(){"use strict";var a,b,c,d=$("#searchbox");$("#search").click(function(){d.toggle()}),a=Backbone.Model.extend({el:$("#projects"),initialize:function(){_.bindAll(this,"loadCSV","loadTemplate","process","render")},foundation_loaded:!1,data:{},rendered:"",num_projects:0,project_filter_count:0,init:function(){this.loadCSV(),this.loadTemplate()},loadCSV:function(){var a=this;$.getJSON("./json/projects.min.json?"+timestamp,function(b){void 0!==b.projects&&(a.data=b.projects,a.num_projects=b.projects.length),void 0!==b.intro&&$("#current .intro_text").html(b.intro),void 0!==b.about&&$("#intro .about").html(b.about),a.trigger("loaded:csv")})},loadTemplate:function(){var a=this;$.get("./views/template.html?"+timestamp,function(b){a.template=b,a.trigger("loaded:template")})},process:function(){if(this.template&&this.data){var a,b="",c={};for(this.project_filter_count=0,a=0;a<this.num_projects;a+=1)void 0===this.data[a].visibility&&(this.data[a].visibility=1),1===this.data[a].visibility&&(this.project_filter_count=this.project_filter_count+1,this.data[a].hasTechnology=void 0===this.data[a].technology&&this.data[a].technology?!1:!0,this.data[a].hasImg=void 0===this.data[a].technology&&this.data[a].technology?!1:!0,this.data[a].imgs.length>=1?(this.data[a].hasImg=!0,this.data[a].imgs.length>1?this.data[a].gallery=this.data[a].imgs:this.data[a].screenshot=this.data[a].imgs):this.data[a].hasImg=!1,void 0===c[this.data[a].idtype]?(this.data[a].hasId=!0,c[this.data[a].idtype]=!0):this.data[a].hasId=!1,b+=Mustache.render(this.template,this.data[a]),$("#progressbar-container #progress").width((a+1)/this.num_projects*100+"%"));this.rendered=b,this.render()}},filter:function(a){var b,c=[];for(console.log("Filtering for: ",a),b=0;b<this.num_projects;b+=1)a.length>0?(c=void 0!==this.data[b].technology&&this.data[b].technology?_.intersection(this.data[b].technology,a):[],this.data[b].visibility=c.length||0):this.data[b].visibility=1},render:function(){$(this.el).html(this.rendered),this.trigger("foundation"),$("#num_projects").text(this.project_filter_count+" Projects"),$("#progressbar-container #progress").width("100%").css("background-color","#FFFFFF")}}),c=new a,c.on("loaded:csv",function(){this.process()}),c.on("loaded:template",function(){this.process()}),c.on("foundation",function(){this.foundation_loaded||(this.foundation_loaded=!0,$(document).foundation())}),c.init(),$(".filter").click(function(){var a=[];_.each($(".filter"),function(b){$(b).prop("checked")===!0&&a.push(b.value)}),$(c.el).html(""),a.length>0?$("#intro, #current").hide():$("#intro, #current").show(),c.filter(a),c.process(),c.render()}),$.ajax({type:"GET",url:"./last-update.php"}).done(function(a){a?$("#modification-date").text(" "+a):$("#last-update").hide()}),$("#intro #contact_link").click(function(a){a.preventDefault(),$("html, body").animate({scrollTop:$("#footer").offset().top},400),$("#footer #contact div").css("background-color","#FFFBF0")}),$("#projects").on("click","img",function(){var a=$("body").scrollTop();state_set("scrollposition",a)}),b=state_get("scrollposition"),b&&($("html, body").animate({scrollTop:b},500),b=null,state_remove("scrollposition"))});